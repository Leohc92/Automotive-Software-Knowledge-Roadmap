## ISO/SAE 21434标准浅解

### 1 背景

2021年8月31日，由SAE和ISO共同制订的，汽车网络安全领域首个国际标准ISO/SAE 21434"Road Vehicles-Cybersecurity engineering"正式发布。

作为道路车辆网络安全标准，ISO/SAE 21434要求覆盖了车辆所有的生命周期，包括概念阶段，开发，生产，运维，报废等所有过程，为开发人员提供了全面的方法来实施整个供应链（开发商，供应商，制造商）的安全保障措施。所以总的来说ISO/SAE 21434是标准，也是方法论，对R155法规的落地起到了支撑作用。

### 2 标准概况

21434框架如下图所示：

![img](https://pic1.zhimg.com/80/v2-0e47ae200805d4870b27ceac8d3181f4_720w.webp)

![img](https://pic3.zhimg.com/80/v2-011c4a5d8a4657e39269d68e81a4d192_720w.webp)

ISO/SAE 21434正式版于2021年8月31日发布，标准共由15个章节组成，其中主体部分为4-15章。

第4章 概述：包含本文件中采用的道路车辆网络安全工程方法的背景和总体信息。

第5章 组织级网络安全管理：包含组织层级网络安全方针、规则和流程的规定和管理要求。

第6章 基于项目的网络安全管理：包含项目层级的网络安全活动和管理要求。

第7章 分布式网络安全活动：包含客户与供应商之间网络安全活动的职责确认的要求。

第8章 持续的网络安全活动：包含对项目生命周期中，需持续实施的风险分析和E/E系统的漏洞管理活动的要求.

第9-14章 描述了从概念设计到产品开发、验证、生产及后期运维和退役全生命周期的网络安全活动和相关要求。

第15章 威胁分析和风险评估方法：提供了一套网络安全威胁分析、风险评估及处置的方法论。

风险管理作为ISO/SAE 21434的核心思想，该标准在各阶段均有相关风险应对，如开发阶段通过TARA分析制订策略来缓解网络安全风险，在运维阶段，通过安全监测，安全事件响应，漏洞管理等持续活动，来应对出现的各种安全风险。



在中国，相关部门也在制订针对车辆的网络安全体系和车辆产品型式市场准入的强制规范与标准。比如工信部组织编制了《关于加强智能网联汽车生产企业及产品准入管理的意见》，《关于加强车联网网络安全和数据安全工作的通知》，提出了对网络安全保护要求，明确企业在网络安全防护中的义务和责任。类似于R155认证的强制规范《汽车整车信息安全技术要求》目前也正在起草中。

### 2.1 第3章 总则

该章节对21434进行了一个总括性的描述，主要是两方面：
[]()
- **研究对象和范围**
- **风险管理的概念**

**研究对象和范围**：在21434中，网络安全工程的研究对象是**item**，可翻译为“相关项”, item定义为：**实现整车特定功能的相关电子器件和软件。**它可以由一个或多个Component组成，具体来说可以是车辆的E/E架构或某个网络安全相关的功能/系统。21434标准只在item层面描述网络安全工程的相关活动，不会规定分配到组件上的具体工程方案。

![img](https://pic2.zhimg.com/80/v2-6deea6dea688dc0c2be0f89ab3317039_720w.webp)

网络安全工程的**范围**包含了车辆的**全生命周期**，因此也包括了售后和服务环节。车辆外部的系统（如后台）在标准中也会涉及，但不是该文件研究的重点。总结来说，21434是一项针对**车端**的网络安全规范。

![img](https://pic4.zhimg.com/80/v2-dbda0f029d0c77d4fb351b79a9ebb473_720w.webp)

**风险管理**：风险管理是21434的核心概念，它是一项贯穿产品整个生命周期的持续性活动。在开发阶段，主要关注**威胁分析和风险评估**（第15章）以及通过**纵深防御**缓解网络安全风险；在运维阶段，通过**安全监控、漏洞管理**和**安全事件响应**等持续的网络安全活动（第8章），处置不断变化的外部环境中出现的安全风险。此外，风险管理活动可针对项目进行相应的适配和裁剪（第6章），对于分布式开发的环节，需要明确客户与供应商的网络安全职责（第7章）。

### 2.2 第5章 组织级网络安全管理

组织级网络安全管理（organizational cybersecurity management）规定了公司/组织层面网络安全管理的要求，是组织内部最高层面的安全方针，标准中从7个方面提出了要求：

![img](https://pic2.zhimg.com/80/v2-432dd5e83950a5eddda34205e3c1f351_720w.webp)

### 2.2.1 网络安全治理（cybersecurity governance）

网络安全治理是最宏观的层面的安全治理方针，总共有5条要求，可总结为以下几点：

- 领导层重视：公司最高层必须具备网络安全管理的概念，认可并且重视网络安全的体系和能力建设，以保证安全工作的顺利实施。
- 流程保证：这里可以理解为CSMS体系的保证，流程包含了**概念、开发、生产、运维、退役、TARA方法论，安全监控，信息共享，应急响应**等21434中提及的所有环节的流程。每个模块的体系文件又可以分为程序、指导手册，方法论和模板多级文件。
- 职责划分：CSMS体系建立好后，必须将各环节的职责分配给相应的部门/人员，确保流程真正落地。
- 资源保证：必须保证相关能力的人员、技术和工具等资源。
- 与现有流程的结合：考虑如何将网络安全管理活动嵌入组织**现有的流程**中。

### 2.2.2 网络安全文化（cybersecurity culture)

这一节规定了组织实施网络安全管理需具备的**“软实力”**，可归结为以下3点：

- 建立**良好**的网络安全文化：对于什么是“良好”的网络安全文化，可参考文件后的附录B，内容和26262中提及的安全文化示例基本一致。
- 保证人员的能力和意识：能力涵盖了多个方面，如具备风险管理的流程和规定，具备功能安全、隐私保护的相关流程规定，人员具备相关专业领域的知识以及渗透、安全防护的知识等。
- 持续改进：持续改进需贯穿在网络安全工程的所有活动中，改进可以来源于内/外部的监控获取的信息、lessons learn, 相似项目的经验，开发过程中发现的问题、体系/流程审核中发现的问题等。

### 2.2.3 信息共享（Information Sharing)

信息共享要求组织必须考虑组织内外部哪些数据共享是必须的、允许的，哪些是被禁止的，并根据这个准则去管理与第三方共享的数据。

在具体实施层面，通常会对信息进行分级，制定相关的信息共享流程，使用专门的信息传输工具，与第三方确定漏洞披露原则等。

### 2.2.4 管理体系（Management System)

组织应建立一个**质量管理体系**来支撑网络安全工程。主要支持网络安全工程中的**变更管理、文档管理、配置管理**和**需求管理**。其中产品的**安全配置信息**必须在产品终止维护前保持可用。此外，本节中还建议组织制定**生产制造环节**的网络安全管理体系。

目前行业内绝大部分企业都通过了16949的认证，在实际实施中需要考虑的是将网络安全开发活动纳入原有的变更、文档、配置和需求管理流程中进行管理。

### 2.2.5 工具管理（Tool Management)

组织应对能够影响相关项和组件网络安全的工具进行管理，这些工具可能包括:

- **开发**过程中的工具如模型开发，静态代码检查，验证工具。
- **生产**中的工具如软件刷写工具、产线检测仪。
- **运维**阶段的工具如在线诊断工具等。

工具可以通过以下的方法进行管理：使用用户手册和勘误表，访问控制，权限控制，预防非预期行为和操作等。

此外，本节还建议在产品退役前，应保持相关环境（如软件编译、开发环境、测试环境）可复制，以便在后续发生网络安全事件时，可对漏洞进行**复现**和管理。

### 2.2.6 信息安全管理（Information security management)

建议：相关的工作产品应该由一个信息安全管理系统来管理

### 2.2.7 网络安全审计（organization cybersecurity audit）

组织应进行网络安全审计，以判断组织的流程是否达到了本标准的要求。需要注意几点：

- 审计人可以来自组织内部或外部，但必须保证审计的**独立性**，关于独立性的要求可以参考26262中的相关描述。
- 网络安全审计可以包含在质量体系的审计中（如IATF 16949）。
- 审计可以分阶段进行

最后在总结一下本章节要求输出的**工作产品**：

[WP-05-01]网络安全方针、规则和流程

[WP-05-02]能力管理、意识管理和持续改进的证据

[WP-05-03]质量管理体系的证据

[WP-05-04]工具管理的证据

[WP-05-05]网络安全审计报告

本章规定了组织最高层级的网络安全管理要求，企业中CSMS的牵头部门应基于本章内容制定企业网络安全管理的总体方针，然后识别和推动各相关责任方建立各自模块（如开发，运维，供应商管理等）的网络安全管理体系。

随着联合国R155法规被纳入GSR，以及国内网络安全标准制定的快速推进，CSMS建设已经变成各大OEM迫在眉睫的工作。强标的驱动保证了网络安全工作在组织中得以自上而下的进行，因此对于相关企业来说，工作的难点就在于识别出网络安全开发流程与现有流程相比，新增了哪些活动，有哪些活动可与现有活动融合，从而在合规的基础上，制定出最适宜、变更成本最低的网络安全管理体系搭建方案。

### 2.3 第6章 项目相关的网络安全管理

项目相关的网络安全管理（Project dependent cybersecurity management) 一章描述了普适性的针对项目网络安全活动的管理原则。包括各项活动的职责分配，制定网络安全活动计划，裁剪原则，以及网络安全案例和网络安全评估、后开发阶段释放的要求。

### 2.3.1 网络安全职责（Cybersecurity Responsibilities)

根据第5章[RQ-05-03]的原则进行沟通和分配。

### 2.3.2 网络安全计划（Cybersecurity Plan)

制定网络安全计划是项目网络安全开发前期一项重要的工作，有以下几个要点：

**1. 识别网络安全开发范围**：通过分析识别出整车中**与网络安全相关的组件**，区分新开发组件和复用组件，并分析判断是否需要对安全活动进行裁剪。对于网络安全相关项的判断，21434中给出了一个参考方法：

![img](https://pic4.zhimg.com/80/v2-49ce04810292f28111100e192ad9c013_720w.webp)

**2. 制定网络安全计划**：根据本文档的规定和裁剪原则，确定项目中需实施的**网络安全活动**，以及各项活动的目的、负责人、所需的资源、开始和结束的时间点以及持续时间、与其它活动或信息的关联、要输出的工作产品。同时还要确定由谁来制定和维护该计划，谁来跟踪计划中安全活动的实施进展。

**3. 与项目计划匹配**：网络安全计划主要规定**概念阶段**和**产品开发阶段**要求的网络安全活动，它应包含在项目计划中，与开发计划相匹配。

**4. 实施证据的管理：**网络安全计划及其相关工作产品需持续维护和更新，并进行**配置管理**和**文档管理**，直至后开发释放。这对于后续形成网络安全案例，进行网络安全评估和后开发释放有重要的意义。

**裁剪（Tailoring)**

在21434中允许对**网络安全活动**进行必要的**裁剪**，在裁剪前必须进行充分的分析和评审，并提供相应的证据，以证明裁剪后仍然可以充分实现21434中要求网络安全的目标。在标准中规定了4种可进行裁剪的情况，分别是**复用**、**独立组件**、**现成组件**和**更新**，在这4种情况下，需根据标准中的要求和建议进行裁剪。

1. **复用（Reuse)**

组件复用在整车研发中十分的常见，即使复用的组件已按照网络安全的要求开发，但是由于复用时组件的变更，运行环境、配置信息等的变化，以及攻击技术的不断发展，新漏洞的发现，仍然需要对其进行必要的分析，实施相应的网络安全活动。在以下几种情况下，需要进行复用的分析：

1. 复用组件发生了修改（包括设计和实施上的修改）
2. 组件在另一个运行环境中复用
3. 不加修改地复用，但相关项或组件的信息发生变化（如已知攻击、漏洞和威胁场景的变化）

以上几乎涵盖了实际开发中95%的情况，因此可以说复用的组件都必须进行复用分析。

在复用分析时，有以下几点需要重点考虑：

1. 确定复用组件修改了哪些地方，或所在环境发生了哪些变化；
2. 分析修改导致的网络安全影响，包括对**网络安全声明的有效性**和之前的**假设**的影响；
3. 确定因此受影响或缺失工作产品，比如TARA中新的资产、威胁场景等。
4. 确定复用的组件是否能满足即将被分配到的网络安全需求

\2. **独立的组件（Component out of context)**

独立的组件通常指供应商开发的通用组件或产品，该组件的开发是基于一个假设的环境，而非基于特定的项目。对于此类组件，21434要求在工作产品中对其预期的用途、环境假设和外部接口进行记录，然后基于以上的假设进行网络安全开发，并对假设和安全声明进行验证。

\3. **现成组件（Off-the-shelf Component）**

现成组件指在不修改其设计和实现情况下集成到系统中的组件，如第三方的软件，开源软件库等。对于此类组件，21434要求其必须收集其相关的网络安全文档，且相关文档需足以支持本文规定的网络安全活动。同时，该组件还要能满足分配到其上的网络安全需求。

### 2.3.3 网络安全案例（Cybersecurity case)

网络安全案例是网络安全评估的对象，它是从概念阶段到开发验证和生产运维阶段整条逻辑链上**完整的网络安全开发证据**，可以通过相应的工作产品加以支持。在形式认证中，认证机构大概率会以网络安全案例为对象，进行相关的审核。

### 2.3.4 网络安全评估（Cybersecurity Assessment)

网络安全评估的对象是某个相关项或组件，依照本文档的规定评估其网络安全的实施情况，评估可基于工作产品和网络安全活动证据，评估的结果包括**接受、带条件接受**和**拒绝**。带条件接受通常会在评估结果中提出整改要求，并会在项目各个阶段对整改项的完成情况进行监控。下图显示了组织网络安全审计，项目网络安全评估和其它网络安全活动之间的关系：

![img](https://pic4.zhimg.com/80/v2-4013bea2bc9aa709b421162707a6e817_720w.webp)

### 2.3.5 后开发的释放（Realease for Post-Development)

这里所说的后开发的释放，其实就是指**开发阶段**完成，批准进入到**生产阶段**。21434规定在进入生产阶段前，必须提供以下工作产品：

1. 网络安全案例
2. 网络安全评估报告
3. 生产阶段的网络安全要求

并且必须保证：

1. 网络安全案例提供的证据是令人信服的
2. 网络安全案例通过了网络安全评估
3. 生产阶段的网络安全要求被接受

最后总结一下本章中需输出的工作产品:

- 网络安全计划
- 网络安全案例
- 网络安全评估报告
- 后开发释放报告

### 2.3.6小结

在欧盟R155法规中，车辆的网络安全准入包含了两个部分: 网络安全体系认证（CSMS）和车辆形式认证（VTA)，本章的内容可作为开展VTA工作的重要参考，它主要规定了在项目角度必须实施的网络安全活动。这部分工作通常由网络安全项目管理工程师负责，其核心内容是在项目前期确定安全工作的范围，并制定相应的网络安全开发计划，规定安全活动和输出的工作产品。在项目实施的过程中，需收集和管理网络安全活动的证据及工作产品，以形成逻辑链完整的网络安全案例。在批产前，需完成相关的网络安全评估和审核。

### 2.4 第7章 分布式网络安全活动

![img](https://pic3.zhimg.com/80/v2-d0e8626c543277b74c265eff86afcdba_720w.webp)

第7章规定了分布式开发中的网络安全活动，可以理解为在网络安全角度如何进行供应商管理。21434是一份面对整个汽车行业的指导标准，因此对供应商管理要求的适用范围不仅限于OEM，同时也适用于Tier 1, Tier 2等供应链上各环节的企业和组织，此外，组织的**内部供应商**也需要遵循本章要求。在21434中，分布式的网络安全活动主要有3项：

- 供应商能力评估
- 报价
- 网络安全职责界定

### 2.4.1 供应商能力评估

供应商网络安全能力的评估类似于16949、ASPICE等其它质量体系的评估，目的在于考察供应商在开发、生产阶段执行相关网络安全活动的能力，评估通常在供应商准入或定点前进行。供应商可提供以下证据以证明其网络安全能力：

1. 以往项目中网络安全开发，治理，质量管理和信息安全方面的最佳实践的证据
2. 证明具备可进行持续的网络安全活动和网络安全事件响应的能力
3. 对过往网络安全评估报告的总结

### 2.4.2 报价

客户应在询价阶段明确提出网络安全相关的需求，包括：

- 相关的网络安全技术需求
- 明确要求供应商按照本文档进行产品的开发（体系要求）
- 要求供应商履行接口协议中约定的职责

在实际定点过程中，通常将网络安全的技术要求和接口协议放在SOR包中，提供给供应商进行报价。

### 2.4.3 网络安全职责界定

在完成供应商定点后，需识别客户和供应商各自执行的网络安全活动，通过签署《网络安全接口协议》确定双方的职责。在后续的分布式开发活动中，双方根据接口协议完成各自的安全活动，以下是21434提供的一个《网络安全接口协议》模板：

![img](https://pic4.zhimg.com/80/v2-89bbbbd00004bc336eab6da467d49df7_720w.webp)

可以看出，接口协议的作用是确定21434中规定的各项网络安全活动客户和供应商分别充当什么角色。这个协议由双方协商确认，例如，零件的TARA由供应商来做，客户进行审批，那么威胁分析和风险评估这项，供应商勾选R（Responsible), 客户勾选A（accountable)。

除了接口协议，客户与供应商的接口还需要规定好：

- 双方的接口联络人
- 信息共享的策略（包括信息共享的流程、工具，漏洞披露的流程等）
- 安全活动的目标里程碑
- 漏洞和风险的反馈机制和网络安全事件的处理机制。

### 2.5 第8章 持续的网络安全活动

第8章主要描述持续的网络安全活动。车辆网络安全工程是一项贯穿产品**全生命周期**的**持续性的活动**，OEM不仅要进行TARA分析、安全概念设计、网络安全开发测试和生产，还要在项目的全生命周期中，持续地收集和监控与项目有关的网络安全信息，建立信息监控和漏洞管理机制，持续地保证产品的网络安全。新漏洞的发现、网络安全突发事件的发生、新攻击技术的出现等都有可能触发相应的网络安全工作。

本章节中描述了4项需要持续进行的网络安全活动：

![img](https://pic4.zhimg.com/80/v2-721cc02b1133f45d4bcbf21fb4d13e1b_720w.webp)

### 2.5.1 网络安全监控（Cybersecurity Monitoring)

网络安全监控要求组织持续地收集网络安全信息（如最新的漏洞，安全事件，攻击技术等），并使用定义的规则对收集的信息进行**筛选**，获取有价值的信息。

监控信息可来源于组织内部或外部。

- **外部来源：**网络安全研究人员、商业/非商业来源、供应链、客户、政府
- **内部来源：**网络安全声明，网络安全规范，过往的漏洞分析，威胁场景，现场获取的信息（如漏洞扫描报告，维修信息，客户使用信息等）

在监控过程中会从各种渠道收集到海量的信息，因此需要定义**触发器(Trigger)**，以从收集的信息中高效地筛选出有价值的网络安全信息。触发器可以是某些关键词，相关的配置信息，组件的名称或供应商的名称。经过Triggers的筛选后的网络安全信息将构成一个或多个**网络安全事件。**

### 2.5.2 网络安全事件评估（Cybersecurity Event Assessment)

对网络安全事件进行评估，识别出相关的组件及其**脆弱点（weakness)**。这一步可以合并到安全监控活动中，通过Trigger直接将安全事件关联到受影响的组件上。

### 2.5.3 漏洞分析（Vulnerability Analysis)

在该环节中，需对脆弱点进行分析，判断其是否构成一个漏洞。在这里可采用TARA分析中的方法，结合组件的架构信息，识别可能的**攻击路径**并计算**攻击可行性**。如果不存在相应的攻击路径，或者攻击可行性非常低，则该脆弱点不构成一个漏洞。否则，该脆弱点将被视为一个漏洞，需要对其进行处置。需要注意的是，对于不构成漏洞的脆弱点，应提供合理的理由。

### 2.5.4 漏洞管理（Vulnerability Management）

需对识别出的漏洞进行管理：

- 应采用TARA中的方法对漏洞进行**风险评估**和**处置**，确保所有不可接受的风险都被良好地处置。
- 也可以通过TARA之外的方法对漏洞进行处置。（例如某第三方软件的漏洞可通过补丁修复，则可直接通过更新补丁处置该漏洞，不需要再走一遍TARA。）
- 部分漏洞如果需要通过应急响应进行处置，则应遵循网络安全事件应急响应流程。

### 2.5.5 小结

该章节主要涉及的是**漏洞管理**的内容，包含了漏洞信息的**收集**，**分析**和**处置**。漏洞信息的收集要求组织建立长效的网络安全信息收集机制，通过内外部多种渠道（如订阅威胁情报服务，供应商上报，监测互联网漏洞平台，定期的漏洞扫描等）收集和识别与项目相关的网络安全事件。在分析阶段，应首先定位安全事件影响的功能、组件，识别脆弱点，然后由业务部门和安全部门对脆弱点进行分析，判断其是否应被作为漏洞进入漏洞管理流程。对于已查明的漏洞，需分析其风险等级，制定漏洞处置计划。针对不同严重等级的漏洞，还应设置对应的漏洞关闭时间，跟踪处置进度直至关闭。

### 2.6 第9章 概念阶段

从第9章至第14章，21434描述了车辆从概念设计到退役的全生命周期各阶段的网络安全要求。第9章概念阶段（Concept phase）的主要工作是定义**网络安全对象**，并通过TARA分析，确定网络安全目标，产生相应的网络安全概念。接下来将对这3个环节进行详细的描述。

![img](https://pic2.zhimg.com/80/v2-5202cd4b575ed700c12bf54847f0221d_720w.webp)

### 2.6.1 对象定义（Item Definition)

首先解释一下什么是“对象”，在21434原文中表述为item，可翻译为“对象”或“相关项”, Item的定义为：**实现整车特定功能的相关电子器件和软件**，它可以由一个或多个Component组成，具体来说可以是整车中实现某个/某类功能的系统、零部件甚至是整车的E/E架构。

item是网络安全工程的研究的对象，它是后续一系列网络安全活动的基础。"item definition"就是要定义研究的对象及其运行环境，以及其在网络安全语境下与其它对象的交互。对象定义可以参考以下输入信息：

| 输入                                                         | 输出     |
| ------------------------------------------------------------ | -------- |
| 对象已有信息及其运行环境，如-包含车内网络的E/E架构-外部网络-参考模型-之前开发的文档 | 对象定义 |

**如何定义对象？**

对象定义必须描述对象的以下基本信息：

- 对象边界
- 功能
- 初步的架构

**举个例子，在该示例中，对象为胎压监测系统。**

- 对象边界**：**对象包含胎压传感器、网关和仪表盘与胎压监测相关的功能，以及这三个模块之间的通讯数据、协议和网络安全措施，对象与其运行环境的接口为网关上的OBD及其相关的诊断功能。
- 功能：该对象的功能为传感器监测胎压信息，然后将处理后的胎压信息显示在仪表盘上。
- 初步架构：初步架构如下图所示，包含了对象涉及的模块、块间的通讯协议以及模块与外部交互的接口等相关信息。

![img](https://pic3.zhimg.com/80/v2-7b9046aaf96372cbf3129f2cacec4682_720w.webp)

描述对象与网络安全相关的运行环境信息，例如对象的外部接口，内部通讯协议信息，以识别可能的攻击界面和路径。相关信息也可以包含假设，例如假设对象内相关的PKI电子认证服务机构默认是安全的等情况，以保证后续的分析过程合理可控。

### 2.6.2 网络安全目标（Cybersecurity goals)

网络安全目标是最高层级的网络安全要求，它基于威胁分析和风险评估（TARA）得出的，TARA的方法论将在第15章中进行介绍。根据网络安全目标制定对应的网络安全要求，对于保留风险和转移风险的项，还应解释其合理性。

| 输入     | 输出                                                         |
| -------- | ------------------------------------------------------------ |
| 对象定义 | 1.TARA结果2.网络安全目标3.网络安全要求4.网络安全目标的核查报告 |

**如何制定网络安全目标？**

- **风险分析**：对上一章定义的对象进行风险分析，分析包含资产识别、威胁场景识别、影响评级、攻击路径分析、攻击可行性分析，风险确定等环节，具体方法在之后的15章中会详细解释。

- **风险处置决策**：根据15章中的方法，确定每个风险项的处置方法，风险处置决策包括消除风险，降低风险，转移风险和保留风险等。

- **制定网络安全目标**：对于需要消除或降低的风险，须制定一个或多个相应的网络安全目标，这个目标通常是High level的，可以用类似“保护xx资产的xx属性”的颗粒度进行描述。目标也包括生产、运维和报废阶段的网络安全目标。21434还在附录E中提供网络安全保证等级（CAL）的分级方法，CAL等级定义了执行网络安全活动的严格程度，因此也可以将CAL等级作为网络安全目标。

- **制定网络安全声明**：对于决定保留和转移的高风险项，以及通过环境假设降低威胁场景风险的风险项，需要制定网络安全声明来阐述适当的理由，且该声明在后续的阶段必须被监控。21434以及车型认证十分重视开发链条逻辑的合理性，因此网络安全声明是概念阶段不可忽视的重要工作。

- **保证完整性和一致性：**这部分属于网络安全质量保证的工作，需要保证以下各环节之间的完整性和一致性：

- - 风险分析与项目定义
  - 风险处置决策与风险分析结果
  - 网络安全目标、声明与风险处置决策
  - 网络安全要求与网络安全目标



### 2.6.3 网络安全概念

网络安全概念包含了网络安全要求和对运行环境的要求，是对于分析对象全面的网络安全需求。

| 输入                                          | 输出                             |
| --------------------------------------------- | -------------------------------- |
| 1.item定义2.网络安全目标3.网络安全声明4.TARA* | 1.网络安全概念2.网络安全核查报告 |

**如何制定网络安全概念？**

- 确定**技术**层面的网络安全控制措施，如通过安全通信处理车外通讯的风险，通过IDPS监测和预防非法入侵口等。
- 基于安全控制措施，制定网络安全要求和对运行环境的要求，以达成相应的网络安全目标。
- 将安全要求分配给对象中对应的组件或零件
- 保证需求与目标的完整性和一致性。

**举个简单的例子：**

| 安全目标                               | 安全控制措施                                | 安全概念                                                     |
| -------------------------------------- | ------------------------------------------- | ------------------------------------------------------------ |
| 保护Tbox与后台之间会话加密密钥的机密性 | 1保证密钥的安全存储2 保证密钥交换过程的安全 | Tbox采用HSM对密钥进行管理2. Tbox与后台应基于TLS协议进行通信3. 应保证后台服务器及其基础服务的安全，后台相关人员可信（运行环境要求） |

### 2.6.4 总结

概念阶段的主要进行3项工作：对象定义；TARA分析；网络安全概念制定。该阶段的工作通常由网络安全开发部门负责，项目的网络安全团队应在项目早期识别项目的范围，对网络安全相关的系统/功能进行TARA分析，识别出高风险的点，针对高风险点制定相应的网络安全控制措施，形成网络安全需求输入给对应的开发部门。

### 2.7 第10章 产品开发

在第9章中，通过对相关项的TARA分析，已经得出了针对高风险项的网络安全要求（网络安全概念），在产品开发阶段，应根据网络安全概念，制定详细的网络安全技术规范，并将需求逐层分解到下游的子系统、零部件层，完成相应的架构设计和详细设计。在V模型右端，进行集成和符合性测试，以保证相关的组件、系统符合V模型左端对应的网络安全设计规范。

![img](https://pic3.zhimg.com/80/v2-ebadd6db38101b072c4a3dad0641dd02_720w.webp)

![img](https://pic4.zhimg.com/80/v2-1ab47e5ba93a20cf72bf842879a60d67_720w.webp)

### 2.7.1 设计阶段

设计阶段的工作与正常的产品功能设计开发基本上是一致的，可将网络安全需求视为其中一类需求正常开发，但仍有以下这些要求需要注意：

- 网络安全技术规范应基于：

- - 更高层级架构设计
  - 可实施的安全控制措施
  - 现有的架构设计



- 网络安全技术规范可包含：

- - 系统内组件之间接口的设计（如接口的用途，动态\静态行为）
  - 生产阶段的安全规范（如密钥存储, debug口移除等）
  - 配置和标定参数（例如TLS的配置，HSM的配置等）
  - 对组件**性能**的要求



- 应使用合适的编码语言和编码规范进行网络安全的开发设计
- 应对架构设计进行**脆弱性分析**，并对识别出来的弱点进行管理
- 应确保网络安全规范与上一层级的规范的**一致性**

### 2.7.2 集成与验证阶段

集成和验证活动的目的是验证开发的组件/系统是否符合对应的网络安全设计规范，制定集成和验证策略应基于：

- 既定的网络安全规范
- 用于批量生产的配置
- 支撑网络安全功能所需的性能
- 建模、设计和编码准则

测试的方法可包含：

- 基于需求的测试
- 接口测试
- 资源利用评估
- 数据流和控制流的验证
- 动态分析
- 静态分析

制定**测试用例**可以通过：

- 对需求的分析
- 等价类分析
- 边界值分析
- 基于知识和经验推测的故障

如果采用测试的方法进行验证，还应评估测试**覆盖率**，保证测试活动的充分性。

此外，21434还建议在子系统和零件层级，通过漏洞扫描、渗透测试、模糊测试等方法，识别潜在的弱点和漏洞。该项测试作为可选项，可根据组件的具体情况进行实施，如果不实施，应提供理由。

### 2.7.3 其他约束

第8.1.4.2.2.3条提到以下信息安全设计的最佳做法：

- 最低特权原则
- 认证
- 授权
- 审核
- 端到端安全
- 架构信任度（接口的隔离、防御的深度）
- 接口隔离(以便进行适当的网络安全分析)
- 保护服务期间的可维护性（测试接口、OBD）
- 开发过程中的可测试性(测试界面)和运行过程
- 默认的安全(简单、不复杂、不依赖专家用户)

此外，系统集成应结合适当的方法进行验证和测试，即(a)基于需求的正向和反向测试，(b)接口测试，(c)渗透测试，(d)漏洞扫描和(e)模糊测试。

对于硬件设计，应考虑以下确保信息安全功能的机制(条款8.2.4.3.3)：

- 设计信息安全领域(领域分离)
- 安全功能自我保护
- 防绕过安全功能
- 确保安全功能初始化

此外，与信息安全有关的硬件元素的所有物理和逻辑接口，应按其目的、用途和参数加以识别。由于接口是网络安全攻击的潜在切入点，应作为脆弱性分析的投入。

对于信息安全相关的软件开发，必须从系统信息安全需求中推导出软件信息安全需求，并分配到软件模块。软件单元设计规范及其实现需要进行静态和动态验证。因此，应考虑安全设计规则和编码准则、域分离、自我保护、非旁路特性和安全初始化定义。

第8.3.4.6.5段规定了软件单元设计和源代码级实现的设计原则，该段中还提到了(a)子程序和函数的正确执行顺序，(b)接口的一致性，(c)数据流和控制流的正确性，(d)简单性、可读性和可理解性，(e)鲁棒性、可验证性和适合软件修改的特性。

### 2.7.4 小结

在整个网络安全开发过程中，相对于传统开发的增量工作主要还是在概念阶段，网络安全部门完成TARA分析并输出整车和系统的网络安全概念之后，相应的业务部门将承接与之相关的安全需求，进行产品的设计和开发。

网络安全需求的开发与其它功能需求的开发本质上是一样的，都是自上而下逐层分解，细化需求，制定设计规范，进行架构设计和详细设计，完成各组件的开发工作。由于网络安全目前还是个比较新的领域，各业务部门、供应商的安全能力参差不齐，在安全开发过程中，需要网络安全团队为业务团队、供应商充分沟通，并提供一定的支持。

在开发阶段还涉及了**供应商管理**的相关内容，对于一些安全要求较高的供应商开发零部件，需要对供应商的网络安全能力进行评估，并通过接口协议约束供应商的责任和义务。这部分的具体内容可参考前面的文章[《分布式网络安全活动》](https://zhuanlan.zhihu.com/p/422875979)。

集成和验证阶段主要是组件、子系统层级的符合性验证，目的是验证开发出来的组件/子系统是否满足V模型左端的设计。**零件/子系统级别的渗透测试**是与传统验证阶段有区别的增量工作，但这在21434中并非强制项，可根据项目的实际情况，对于一些网络安全强相关的组件/控制器，进行相关的漏洞扫码、渗透测试和模糊测试。

### 2.8 第11章 网络安全确认

第11章节的题目是“Cybersecurity Validation", 可译为**”网络安全确认“**。这里的Validation需要与上一章节产品开发中的Verification进行一下区分。**"Verification"**我们通常理解为是否**“do the things right“**，即验证开发是否满足设计阶段的规范和要求，对象通常是零件或子系统。而本章节的**”Validation“**则是验证是否**”do the right things“**，即所开发的产品**是否满足网络安全的目标**，更直白的讲，是验证车辆是否安全。在该阶段，确认活动的对象是**整车**，并且是符合量产状态的整车。

该阶段的主要目标有以下3个：

- 验证网络安全目标和网络安全声明
- 确认对象达到了网络安全目标
- 确认没有不合理的风险存在

**如何进行网络安全确认？**

渗透测试：通过渗透测试来验证网络安全目标是否实现，以及网络安全声明的有效性。除此之外，渗透测试还可验证网络安全目标是否充分，车辆是否还存在未被识别的风险 ，如果发现之前未识别的风险，则需要重新进行分析，制定安全目标并对其进处置。渗透测试通常是黑盒测试或灰盒测试，测试的效果很大程度上也取决于测试工程师的经验和专业能力，这部分工作也属于传统开发过程中没有的**增量工作**，主机厂通常需要建立专门的团队或通过第三方实验室完成该环节的工作。

专家评审：对于一些难以通过测试验证的目标和声明的目标，评审也是一个重要的方法。通过专家评审、跨部门联合评审的方法，对概念阶段和开发阶段的输出物进行评审，以确认网络安全目标是否已实现，网络安全声明是否有效，开发过程中发现的弱点和漏洞是否得到了有效管理。需要注意的是，应保证网络安全确认的完整性和一致性，对于每项目标和声明确认的方法和理由应进行说明。

网络安全确认结束后应输出一份**网络安全确认报告，**该份报告应作为必要的交付物在SOP前完成交付。

### 2.9 第12-14章 后开发阶段

第12章 **生产**，第13章 **运营与维护**和第14章 **结束网络安全支持和停用**被统称为“后开发阶段（Post-development)”

### 2.9.1 第12章 生产

生产的范围包含了零部件、系统、整车的**生产**和**装配**，包含在OEM，供应的工厂的生产活动。21434中对于生产过程的要求有两条：

**1）应实现与生产有关的网络安全需求：**

在第9章和第10章产品开发中我们曾经提到过，制定网络安全概念和规范时，可能会产生与生产有关的网络安全需求（如密钥注入，关闭调试口等要求），这些需求需要在生产环节中实施。因此应建立该类需求向生产部门传递的机制，生产部门在承接该类需求后，通过**生产控制计划**保证需求在生产环节得到实施。生产控制计划规定了实施这类需求的步骤，使用的工具及安全控制措施（如访问控制，权限控制等）

2）**防止在生产过程中引入漏洞：**

这项要求一方面通过上面提到的从开发阶段输入的生产需求保证，另一方面需要依靠生产环境的信息安全保证来支撑，通常OEM会要求工厂或供应商通过TISAX或27000的认证，以保证生产环境的安全，避免在生产过程中引入漏洞和风险。

### 2.9.2 第13章 运营与维护

运维阶段的活动有两个：**网络安全事件响应**和**更新**。

网络安全事件由漏洞管理流程触发，当漏洞发展成为网络安全事件后，通过应急响应对安全事件进行处置。

更新指因漏洞修复，功能改进等原因对系统或组件进行更改，例如售后更新，OTA等，更新活动发生在**车辆销售之后**，对于概念、开发和生产阶段的更改，属于变更管理的范畴，不属于更新。

**1）处理网络安全事件**

针对每个网络安全事件，应制定事件响应计划，计划应包括：

- 补救措施
- 沟通计划：包含了内部和外部（如客户、政府、机构等）的沟通机制。
- 补救措施的职责分配：包括了专业方面的负责人、组织方面的负责人（如流程、法务等）和决策者等。
- 信息记录的机制：应记录与安全事件相关的信息，如受影响的组件，漏洞，日志数据，崩溃数据，客户的反馈等。
- 制定补救计划完成进度的评价指标，如补救措施修复组件的百分比等
- 结束响应关闭和结束动作

计划制定完成后，应保证按计划实施，并跟踪实施情况直至事件响应关闭。

2）**更新**

对于更新的要求21434中只提了一句：**更新及与更新相关的能力应按本文档的要求开发。**在联合国**R156**法规中对于车辆的软件更新提出了相应的要求，其中也包含了网络安全方面的要求，目前各大OEM在软件更新方面主要依照该项法规进行实施。

### 2.9.3 第14章 结束网络安全支持和停用

停用和结束网络安全支持是两个不同的概念 。组织可以结束对某个对象/组件的网络安全支持，但是其依然能够按原有设计正常运行。而用户停用某个对象和组件可能会在组织不知情的情况下发生，组织无法执行相应的停用程序。

21434中对于结束网络安全支持提出的要求是：应建立一个机制，在组织决定停止对该项目或组件的网络安全支持时向客户通报。对于停用，则要求在制定后开发阶段的网络安全要求时应考虑停用的影响。

### 2.10 第15章 TARA分析

本标准描述了确定道路使用者受威胁情景影响程度的方法，这些方法从受影响的道路使用者的角度进行，被统称为威胁分析和风险评估（TARA）。本标准中定义的方法是通用模块，可以在相关项或部件的生命周期的任何阶段使用，包含以下过程及其要求：

**1、资产识别（Asset identification）：**

了解什么会受到危害

按照标准的陈述：识别项目或组件的破坏破坏场景和资产…

**2、威胁场景识别（Threat scenario identification）：**

了解资产会如何受到危害

按照标准的陈述：根据所分析资产的网络安全属性识别威胁场景

**3、影响打分（Impact rating）：**

威胁将导致多大的危害

按照标准的陈述：根据损失场景 (3.1.18) 评估损失或人身伤害的大小。

**4、攻击路径分析（Attack path analysis）：**

什么行为导致了威胁

按照标准的陈述：识别并将潜在攻击路径与一个或多个威胁场景关联

**5、攻击可能性打分（Attack feasibility rating）：**

危害发生的可能性有多大

按照标准的陈述：基于易受攻击性对攻击路径进行可行性评级

![img](https://pic4.zhimg.com/80/v2-57bbcdcc32903e64ebf417bf7d2c7ffb_720w.webp)

**6、风险值识别（Risk value determination）：**

威胁导致的风险有多大

按照标准的陈述：确定威胁场景的风险值

**7、风险处理决策（Risk treatment decision）：**

如何应对风险

按照标准的陈述：通过选择适当的风险处理选项应对所识别的风险

TARA分析帮助开发人员系统性地找出目标存在的安全问题，然后妥善地处置这些问题，重点在于系统性，而不是纯靠开发人员的灵光一闪。ISO 21434定义的TARA规范示意图如下。“风险值 = 攻击可行性 × 损害程度”作为中心思想，以此判定CAL等级，确认处置措施。攻击树分析是核心的环节，表述了抽象的威胁场景具体有哪些实现路径。下面简要分析如何做攻击树模型。

![img](https://pic4.zhimg.com/80/v2-1209f63689834bedc75a7e3180b868f3_720w.webp)

图1 TARA方法论

攻击树模型的一个总要前置条件是确认安全目标。这里以整车电子电气架构作为一个示例去考虑系统边界，暴露在最外侧的是各种物理接口和传感器，再往内就是各种通讯总线，处于端点的是控制器。从信息交互实体和传播路径考虑，边界内的主要的安全资产可以分类为：

- 各类物理接口
- ECU固件
- 总线通信
- 用户数据
- 密码学相关数据
- 服务或功能

![img](https://pic1.zhimg.com/80/v2-587986d57cfac1dc635b3895fd1db824_720w.webp)

图2 整车系统边界

安全属性模型，有经典的CIA，还有STRIDE威胁模型（对应6个属性），对于车载网络环境，更适合的是EVITA提出的模型（8种），包含以下安全属性：

- 真实性（身份认证）
- 完整性
- 可用性
- 授权
- 抗否认性
- 新鲜度
- 匿名
- 机密性

可以将资产和安全属性做一个映射，如下表所示：

![img](https://pic4.zhimg.com/80/v2-b8c0045d3f113476bf4df4945e88b32f_720w.webp)

安全目标可以看作是保护资产的安全属性，那么威胁则是资产的安全属性可能遭到破坏的场景，损害场景则是相应威胁可能导致的破坏或造成的损失。

- 安全目标 = 保护资产X的安全属性Y
- 威胁场景 = 何种方式破坏资产X的安全属性Y
- 损害场景 = 破坏资产X的安全属性Y后可能导致的损害

以ECU固件的完整性为例，安全目标是保护ECU固件的完整性。完整性遭到破坏，即固件遭到篡改，为ECU固件的威胁场景。而具体遭到篡改的数据位置不同，造成的后果也不同，可能有以下几种损害场景：

- 篡改了代码段，修改了ECU功能，车辆功能发生变化
- 篡改了代码段，植入后门
- 篡改了代码段，屏蔽了认证过程，提升权限
- 篡改了标定数据，车辆性能发生了变化
- 篡改了车辆配置，激活了未付费购买的功能

具体的攻击树实现路径分析，严重依赖于网络安全开发人员的经验。我们也可以参考一些开源的攻击路径数据库，如CAPEC。CAPEC数据库从多个视角对攻击路径进行了分类，常用的有按攻击机制分类和按域分类。这些分类也可以作为参考，进行枚举攻击路径。

**按照攻击域来分类：**

- 3000 - Domains of Attack
- Software - (513)
- [http://capec.mitre.org/data/definitions/513.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/513.html)
- Hardware - (515)
- [http://capec.mitre.org/data/definitions/515.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/515.html)
- Communications - (512)
- [http://capec.mitre.org/data/definitions/512.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/512.html)
- Supply Chain - (437)
- [http://capec.mitre.org/data/definitions/437.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/437.html)
- Social Engineering - (403)
- [http://capec.mitre.org/data/definitions/403.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/403.html)
- Physical Security - (514)
- [http://capec.mitre.org/data/definitions/514.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/514.html)

**按照攻击机制来分类：**

- 1000 - Mechanisms of Attack
- Engage in Deceptive Interactions - (156)
- [http://capec.mitre.org/data/definitions/156.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/156.html)
- Abuse Existing Functionality - (210)
- [http://capec.mitre.org/data/definitions/210.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/210.html)
- Manipulate Data Structures - (255)
- [http://capec.mitre.org/data/definitions/255.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/255.html)
- Manipulate System Resources - (262)
- [http://capec.mitre.org/data/definitions/262.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/262.html)
- Inject Unexpected Items - (152)
- [http://capec.mitre.org/data/definitions/152.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/152.html)
- Employ Probabilistic Techniques - (223)
- [http://capec.mitre.org/data/definitions/223.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/223.html)
- Manipulate Timing and State - (172)
- [http://capec.mitre.org/data/definitions/172.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/172.html)
- Collect and Analyze Information - (118)
- [http://capec.mitre.org/data/definitions/118.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/118.html)
- Subvert Access Control - (225)
- [http://capec.mitre.org/data/definitions/225.html](https://link.zhihu.com/?target=http%3A//capec.mitre.org/data/definitions/225.html)

R155法规也提供了一个威胁的攻击方法清单（附录5表格A1），可用于自查枚举结果是否完备。

![img](https://pic1.zhimg.com/80/v2-9900d78f77932e5bf2a97a1912c155e0_720w.webp)

由于攻击树和对应的措施严重依赖专家经验，建议建立一个汽车电子电气架构的通用技术攻击路径数据库，数据库有多个视图，可以从资产类别、安全属性、攻击机制等方式进行分类。再配合可视化工具从系统的拓扑图上分析，从根节点出发，沿着数据流画出攻击路径上需要经过的节点，以及每个节点或通讯管道的哪些安全属性遭到破坏。我们可以先不考虑每个步骤的可行性有多大，画出如下路径图。

![img](https://pic1.zhimg.com/80/v2-ac5e60696f0631ac155889deacf2e1d0_720w.webp)

图3 攻击路径上标注节点安全属性示例

然后开发人员可以适用工具从数据库中根据安全属性、资产种类查询到对应节点存在哪些攻击方法，包括攻击方法描述、前置条件、攻击原理与示例说明、相关漏洞、减缓措施，并从前置条件可以推断此攻击方法是否适用当前节点，即可完成攻击树模型的确定。当电气拓扑很复杂，或者是目标资产的分发路径多样化，导致攻击分支过于庞杂时，可以做适当的裁剪，当识别到某个路径的可行性非常低时，可无需继续向下展开分析。

### 2.11 附录A 输出成果物汇总

![img](https://pic3.zhimg.com/80/v2-f07d707a6a8be229633cb73d90b38762_720w.webp)

![img](https://pic3.zhimg.com/80/v2-a1bd05a791245e59848830861ce47fee_720w.webp)

![img](https://pic2.zhimg.com/80/v2-c81749e8e5ec89d1154b920185873289_720w.webp)

### 2.12 附录B 网络安全文化例子

![img](https://pic2.zhimg.com/80/v2-2cae250fc3371d65c0adc69ebc3edd45_720w.webp)

![img](https://pic1.zhimg.com/80/v2-03a3750ab0f5a299aabc484d5fd83f90_720w.webp)

### 2.14 CAL与TARA分析具体打分和应用例子

内容太多，详见ISO SAE21434的附录E到H，有具体的打分项和打分范围，以及例子，实际应用现查或者根据公司做好的tara分析模板自动填写计算值即可。

### 3 R155与ISO21434关系

ISO21434标准定义了车辆网络安全的完整框架和产品网络安全生命周期的相关流程，对R155法规的落地起到支撑作用，尤其是有助于车辆制造商在供应链上实施CSMS要求。对于法规中的相关要求，可通过描述文件、技术文件、演示、审计等手段来证明。

通过对比了解到R155和ISO/SAE 21434之间的相同点与不同点。相同点就是二者都要求在车辆整个生命周期均实施网络安全。其次，二者对组织内部建立网络安全管理体系均提出相关要求。不同点是属性方面，法规是具有地域限制的。R155适用于欧盟国家，ISO/SAE 21434则属于行业内标准，无地域限制及法律约束。另一个不同点ISO/SAE 21434在具体操作层面上给出了更详尽的指导，如标准中有专门对TARA分析以及参考模型的介绍等。